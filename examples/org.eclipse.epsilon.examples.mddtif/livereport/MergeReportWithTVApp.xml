<?xml version="1.0"?>
<project default="main">
	
	<epsilon.emf.register file="../metamodels/TVAppDsl.ecore"/>
	<epsilon.emf.register file="../metamodels/ReportDsl.ecore"/>
		
	<epsilon.loadModel name="Report" type="EMF">
		<parameter name="modelUri" value="file://${basedir}/models/Report.model"/>
		<parameter name="metamodelUri" value="ReportDsl"/>
		<parameter name="isMetamodelFileBased" value="false"/>
		<parameter name="readOnLoad" value="true"/>
	</epsilon.loadModel>
	
	<epsilon.loadModel name="OldTVApp" type="EMF">
		<parameter name="aliases" value="Source"/>
		<parameter name="modelUri" value="file://${basedir}/models/TVApp1.model"/>
		<parameter name="metamodelUri" value="TVAppDsl"/>
		<parameter name="isMetamodelFileBased" value="false"/>
		<parameter name="readOnLoad" value="true"/>
	</epsilon.loadModel>	
	
	<epsilon.loadModel name="NewTVApp" type="EMF">
		<parameter name="aliases" value="Target"/>
		<parameter name="modelUri" value="file://${basedir}/models/TVApp2.model"/>
		<parameter name="metamodelUri" value="TVAppDsl"/>
		<parameter name="isMetamodelFileBased" value="false"/>
		<parameter name="readOnLoad" value="false"/>
	</epsilon.loadModel>

	<target name="main">
		
		<epsilon.ecl src="MatchReportWithTVApp.ecl" exportmatchtrace="trace">
			<model ref="OldTVApp"/>
			<model ref="Report"/>
		</epsilon.ecl>

		<epsilon.evl src="ValidateReport.evl">
			<model ref="OldTVApp"/>
			<model ref="Report"/>
			<uses ref="trace"/>
		</epsilon.evl>
			
		<epsilon.eml src="MergeReportWithTVApp.eml" usematchtrace="trace">
			<model ref="OldTVApp"/>
			<model ref="Report"/>
			<model ref="NewTVApp"/>
		</epsilon.eml>
		
		<epsilon.storeModel model="NewTVApp"/>
		
	</target>
	
</project>